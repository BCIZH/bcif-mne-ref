# æ•°æ®æ¨¡å‹å¯¹æ¯”: MNE-Python vs Brainstorm3

> **ä¸“é¢˜**: æ ¸å¿ƒæ•°æ®ç»“æ„è®¾è®¡å·®å¼‚åˆ†æ  
> **æ›´æ–°**: 2026å¹´1æœˆ31æ—¥

---

## ç›®å½•

1. [è®¾è®¡å“²å­¦å¯¹æ¯”](#è®¾è®¡å“²å­¦å¯¹æ¯”)
2. [æ•°æ®å®¹å™¨ç»“æ„](#æ•°æ®å®¹å™¨ç»“æ„)
3. [æ–‡ä»¶æ ¼å¼ç­–ç•¥](#æ–‡ä»¶æ ¼å¼ç­–ç•¥)
4. [å†…å­˜ç®¡ç†æœºåˆ¶](#å†…å­˜ç®¡ç†æœºåˆ¶)
5. [å…ƒæ•°æ®å¤„ç†](#å…ƒæ•°æ®å¤„ç†)
6. [äº’æ“ä½œæ€§](#äº’æ“ä½œæ€§)

---

## è®¾è®¡å“²å­¦å¯¹æ¯”

### MNE-Python: é¢å‘å¯¹è±¡ + å‡½æ•°å¼

**æ ¸å¿ƒç†å¿µ**: "ä¸€åˆ‡çš†å¯¹è±¡ï¼Œæ“ä½œå³æ–¹æ³•"

```python
# Pythonç±»å±‚æ¬¡ç»“æ„
class BaseRaw(ProjMixin, FilterMixin, TimeMixin, ...):
    """è¿ç»­æ•°æ®åŸºç±»"""
    
    def __init__(self, info, preload=False):
        self.info = info            # Infoå¯¹è±¡ (å…ƒæ•°æ®)
        self._data = None           # ndarray (æ‡’åŠ è½½)
        self.annotations = None     # Annotationså¯¹è±¡
    
    def filter(self, l_freq, h_freq):
        """æ»¤æ³¢æ–¹æ³• - è¿”å›selfæ”¯æŒé“¾å¼è°ƒç”¨"""
        self._data = apply_filter(self._data, ...)
        return self
    
    def crop(self, tmin, tmax):
        """è£å‰ªæ–¹æ³•"""
        return self

# é“¾å¼è°ƒç”¨ç¤ºä¾‹
raw = (mne.io.read_raw_fif('data.fif', preload=True)
       .filter(1, 40)
       .set_eeg_reference('average')
       .crop(tmin=10, tmax=60))
```

**ç‰¹ç‚¹**:
- âœ… **å¼ºç±»å‹**: æ¯ç§æ•°æ®æœ‰ä¸“é—¨çš„ç±» (Raw, Epochs, Evoked, SourceEstimate)
- âœ… **æ–¹æ³•ä¸°å¯Œ**: æ¯ä¸ªå¯¹è±¡éƒ½æœ‰å‡ åä¸ªæ–¹æ³• (plot, filter, resample...)
- âœ… **å†…å­˜é«˜æ•ˆ**: æ”¯æŒå»¶è¿ŸåŠ è½½ (`preload=False`)
- âœ… **Pythonic**: éµå¾ªPythonæƒ¯ä¾‹ (é­”æœ¯æ–¹æ³•, è¿­ä»£å™¨, ä¸Šä¸‹æ–‡ç®¡ç†å™¨)

---

### Brainstorm3: ç»“æ„ä½“ + æ–‡ä»¶æ•°æ®åº“

**æ ¸å¿ƒç†å¿µ**: "æ•°æ®å³æ–‡ä»¶ï¼Œæ“ä½œå³è¿›ç¨‹"

```matlab
% MATLABç»“æ„ä½“å±‚æ¬¡
Protocol
  â”œâ”€â”€ SUBJECTS/
  â”‚     â””â”€â”€ Subject001/
  â”‚           â”œâ”€â”€ brainstormsubject.mat
  â”‚           â”œâ”€â”€ subjectimage_T1.mat       % MRI
  â”‚           â””â”€â”€ tess_cortex_pial_low.mat  % è¡¨é¢
  â””â”€â”€ STUDIES/
        â””â”€â”€ @default_study/
              â”œâ”€â”€ channel_vectorview306.mat  % é€šé“
              â”œâ”€â”€ data_block001.mat          % è®°å½•
              â”œâ”€â”€ headmodel_surf_os_meg.mat  % å¤´æ¨¡å‹
              â””â”€â”€ results_MN_MEG_KERNEL.mat  % æºä¼°è®¡

% æ•°æ®ç»“æ„ç¤ºä¾‹
DataMat = struct(...
    'F',            data,           % [nChannels Ã— nTime]
    'Time',         time_vector,    % [1 Ã— nTime]
    'ChannelFlag',  flags,          % [nChannels Ã— 1]
    'Events',       events_array,   % äº‹ä»¶ç»“æ„æ•°ç»„
    'Comment',      'Raw data',     % æè¿°
    'DataType',     'recordings',   % ç±»å‹
    'History',      history         % æ“ä½œå†å²
);
```

**ç‰¹ç‚¹**:
- âœ… **æ–‡ä»¶æŒä¹…åŒ–**: æ¯æ¬¡æ“ä½œéƒ½ä¿å­˜åˆ°.matæ–‡ä»¶
- âœ… **GUIåŒæ­¥**: æ–‡ä»¶æ ‘å®æ—¶åæ˜ æ•°æ®çŠ¶æ€
- âœ… **å†å²è¿½è¸ª**: æ¯ä¸ªæ–‡ä»¶åŒ…å«æ“ä½œå†å²
- âœ… **è·¨ä¼šè¯**: å…³é—­ç¨‹åºåçŠ¶æ€å®Œæ•´ä¿ç•™

---

## æ•°æ®å®¹å™¨ç»“æ„

### 1. è¿ç»­æ•°æ® (Raw/Continuous Data)

#### MNE-Python: Raw å¯¹è±¡

```python
class BaseRaw:
    """
    æ ¸å¿ƒå±æ€§:
    """
    info: Info
        # å…ƒæ•°æ®å®¹å™¨
        - ch_names: List[str]         # é€šé“å
        - sfreq: float                # é‡‡æ ·ç‡
        - ch_types: List[str]         # é€šé“ç±»å‹
        - chs: List[dict]             # é€šé“è¯¦æƒ… (ä½ç½®, æ ¡å‡†...)
        - meas_date: datetime         # é‡‡é›†æ—¶é—´
        - dev_head_t: ndarray         # è®¾å¤‡-å¤´éƒ¨å˜æ¢çŸ©é˜µ
        
    _data: ndarray [n_channels Ã— n_times]
        # æ—¶é—´åºåˆ—æ•°æ®
        - dtype: float64 (é»˜è®¤) æˆ– float32
        - å†…å­˜æ˜ å°„æ”¯æŒ (å¤§æ–‡ä»¶)
        
    annotations: Annotations
        # æ—¶é—´æ ‡æ³¨
        - onset: ndarray              # èµ·å§‹æ—¶é—´ (ç§’)
        - duration: ndarray           # æŒç»­æ—¶é—´
        - description: List[str]      # æè¿° (å¦‚ 'BAD_noise')
    
    first_samp: int
        # ç¬¬ä¸€ä¸ªæ ·æœ¬çš„æ—¶é—´æˆ³ (æ”¯æŒåˆ†æ®µæ–‡ä»¶)
    
    last_samp: int
        # æœ€åä¸€ä¸ªæ ·æœ¬çš„æ—¶é—´æˆ³

# ç¤ºä¾‹
raw = mne.io.read_raw_fif('data.fif', preload=False)
print(raw)
# <Raw | data.fif, 306 x 60000 (60.0 s), ~141.1 MB, data not loaded>

print(raw.info['sfreq'])       # 1000.0 Hz
print(raw.ch_names[:3])        # ['MEG 0113', 'MEG 0112', 'MEG 0111']
print(raw.get_data().shape)    # (306, 60000) - è‡ªåŠ¨åŠ è½½
```

**è®¾è®¡ä¼˜åŠ¿**:
- å»¶è¿ŸåŠ è½½èŠ‚çœå†…å­˜ (å¤„ç†TBçº§æ•°æ®é›†)
- æ”¯æŒå†…å­˜æ˜ å°„ (è¶…å¤§æ–‡ä»¶ä¸å®Œå…¨åŠ è½½)
- åˆ†æ®µæ–‡ä»¶é€æ˜å¤„ç† (è‡ªåŠ¨æ‹¼æ¥)

---

#### Brainstorm3: Data ç»“æ„ä½“

```matlab
% æ–‡ä»¶: STUDIES/@default_study/data_raw.mat

DataMat = 
    F: [306Ã—60000 double]              % æ•°æ®çŸ©é˜µ
    Time: [1Ã—2 double]                 % [èµ·å§‹æ—¶é—´, é‡‡æ ·é—´éš”]
    Comment: 'Raw data (1000 Hz)'      % æè¿°
    ChannelFlag: [306Ã—1 double]        % é€šé“æ ‡è®° (1=å¥½, -1=å)
    Events: [1Ã—N struct]               % äº‹ä»¶æ•°ç»„
        .label: 'stim'
        .times: [1Ã—M double]           % äº‹ä»¶æ—¶é—´ç‚¹
        .epochs: [1Ã—M double]          % æ‰€å±è¯•æ¬¡
        .channels: cell                % å…³è”é€šé“
    DataType: 'recordings'             % æ•°æ®ç±»å‹
    Device: 'Vectorview'               % è®¾å¤‡
    History: {Nx2 cell}                % æ“ä½œå†å²
        {'filter', 'Band-pass:1-40Hz'}
        {'reference', 'Average reference'}
```

**è®¾è®¡ä¼˜åŠ¿**:
- æ‰€æœ‰ä¿¡æ¯è‡ªåŒ…å« (å•æ–‡ä»¶åŒ…å«å®Œæ•´ä¸Šä¸‹æ–‡)
- å†å²è®°å½•å®Œæ•´ (å¯å®¡è®¡)
- GUIå‹å¥½ (ç›´æ¥æ˜¾ç¤ºç»“æ„ä½“å­—æ®µ)

---

### 2. äº‹ä»¶ç›¸å…³æ•°æ® (Epochs/Trials)

#### MNE-Python: Epochs å¯¹è±¡

```python
class BaseEpochs:
    """
    æ ¸å¿ƒå±æ€§:
    """
    info: Info                         # ç»§æ‰¿è‡ªRaw
    
    _data: ndarray [n_epochs Ã— n_channels Ã— n_times]
        # ä¸‰ç»´æ•°æ®
        - æ”¯æŒåˆ†ç±»ç´¢å¼•: epochs['stim1']
        - æ”¯æŒæ¡ä»¶ç»„åˆ: epochs['stim1', 'stim2']
    
    events: ndarray [n_events Ã— 3]
        # äº‹ä»¶æ•°ç»„
        - [:, 0]: æ ·æœ¬ç´¢å¼•
        - [:, 1]: æ—§äº‹ä»¶ID (ç”¨äºåˆå¹¶)
        - [:, 2]: äº‹ä»¶ID
    
    event_id: dict
        # äº‹ä»¶åç§°æ˜ å°„
        # {'stim1': 1, 'stim2': 2}
    
    tmin, tmax: float
        # æ—¶é—´çª—å£ (ç›¸å¯¹äº‹ä»¶è§¦å‘)
    
    baseline: tuple
        # åŸºçº¿æ ¡æ­£çª—å£ (tmin, tmax)
    
    selection: ndarray
        # é€‰ä¸­çš„è¯•æ¬¡ç´¢å¼• (æ”¯æŒæ‹’ç»åè¯•æ¬¡)
    
    drop_log: tuple
        # æ‹’ç»åŸå› è®°å½•
        # (('IGNORED',), (), ('EOG',), ...)

# ç¤ºä¾‹
epochs = mne.Epochs(
    raw, events, 
    event_id={'stim': 1}, 
    tmin=-0.2, tmax=0.5, 
    baseline=(None, 0),
    preload=True
)

print(epochs)
# <Epochs | 100 events (all good), -0.2 â€“ 0.5 s, baseline [None, 0], ...>

# åˆ†ç±»ç´¢å¼•
epochs_subset = epochs['stim']  # è¿”å›æ–°çš„Epochså¯¹è±¡
data = epochs.get_data()        # (100, 306, 700) ndarray
```

**è®¾è®¡ä¼˜åŠ¿**:
- çµæ´»çš„äº‹ä»¶é€‰æ‹©è¯­æ³•
- è‡ªåŠ¨åŸºçº¿æ ¡æ­£
- å†…ç½®åè¯•æ¬¡æ‹’ç»é€»è¾‘

---

#### Brainstorm3: Trials æ•°æ®

```matlab
% ä¸¤ç§å­˜å‚¨æ–¹å¼:

% æ–¹å¼1: å•ä¸ªæ–‡ä»¶åŒ…å«æ‰€æœ‰è¯•æ¬¡ (ç´§å‡‘æ ¼å¼)
DataMat =
    F: [306Ã—700Ã—100 double]            % [é€šé“ Ã— æ—¶é—´ Ã— è¯•æ¬¡]
    Time: [1Ã—700 double]               % æ—¶é—´å‘é‡ (-0.2 åˆ° 0.5ç§’)
    Trials: [1Ã—100 struct]             % è¯•æ¬¡å…ƒæ•°æ®
        (1).label: 'stim'
        (1).indices: 1
    Comment: 'Avg: stim (100 files)'
    DataType: 'data'

% æ–¹å¼2: æ¯ä¸ªè¯•æ¬¡ä¸€ä¸ªæ–‡ä»¶ (çµæ´»æ ¼å¼)
% data_trial001.mat, data_trial002.mat, ...
% æ¯ä¸ªæ–‡ä»¶åŒ…å«: F [306Ã—700], Time, Events
```

**è®¾è®¡ä¼˜åŠ¿**:
- ä¸¤ç§æ ¼å¼é€‚åº”ä¸åŒåœºæ™¯
- å•è¯•æ¬¡æ–‡ä»¶ä¾¿äºå¹¶è¡Œå¤„ç†
- ç´§å‡‘æ ¼å¼èŠ‚çœç£ç›˜ç©ºé—´

---

### 3. å¹³å‡æ•°æ® (Evoked/Average)

#### MNE-Python: Evoked å¯¹è±¡

```python
class Evoked:
    """
    æ ¸å¿ƒå±æ€§:
    """
    info: Info
    
    data: ndarray [n_channels Ã— n_times]
        # å¹³å‡åçš„æ•°æ®
    
    times: ndarray [n_times]
        # æ—¶é—´å‘é‡
    
    nave: int
        # å¹³å‡çš„è¯•æ¬¡æ•°
    
    comment: str
        # æ¡ä»¶æè¿° (å¦‚ 'stim1')
    
    kind: str
        # æ•°æ®ç±»å‹ ('average' æˆ– 'standard_error')
    
    baseline: tuple
        # åŸºçº¿æ ¡æ­£å‚æ•°

# ç¤ºä¾‹
evoked = epochs.average()
print(evoked)
# <Evoked | 'stim' (average, N=100), -0.2 â€“ 0.5 s, 306 ch, ...>

evoked.plot()  # è´è¶å›¾
evoked.plot_topomap(times=[0.1, 0.2, 0.3])  # æ‹“æ‰‘å›¾
```

---

#### Brainstorm3: Average æ•°æ®

```matlab
DataMat =
    F: [306Ã—700 double]                % å¹³å‡æ•°æ®
    Time: [1Ã—700 double]
    Std: [306Ã—700 double]              % æ ‡å‡†å·® (å¯é€‰)
    nAvg: 100                          % è¯•æ¬¡æ•°
    Comment: 'Avg: stim (100 files)'
    DataType: 'data'
    DisplayUnits: 'fT'                 % æ˜¾ç¤ºå•ä½
```

---

### 4. æºç©ºé—´æ•°æ® (Source Estimates)

#### MNE-Python: SourceEstimate å¯¹è±¡

```python
class SourceEstimate:
    """
    æ ¸å¿ƒå±æ€§:
    """
    data: ndarray [n_vertices Ã— n_times]
        # æºæ¿€æ´»æ—¶é—´åºåˆ—
    
    vertices: list of ndarray
        # æ¯ä¸ªåŠçƒçš„é¡¶ç‚¹ç´¢å¼•
        # [lh_vertices, rh_vertices]
    
    tmin: float
        # èµ·å§‹æ—¶é—´
    
    tstep: float
        # æ—¶é—´æ­¥é•¿
    
    subject: str
        # å—è¯•è€…åç§°

# ç¤ºä¾‹
stc = mne.minimum_norm.apply_inverse(evoked, inv, lambda2=1/9)
print(stc)
# <SourceEstimate | 7498 vertices, tmin=-0.2, tmax=0.5, tstep=0.001>

stc.plot(subjects_dir='/path/to/subjects', hemi='split')
```

**ç‰¹æ®Šç±»å‹**:
- `SourceEstimate`: è¡¨é¢æº (çš®å±‚)
- `VolSourceEstimate`: ä½“æº (å…¨è„‘ä½“ç´ )
- `MixedSourceEstimate`: æ··åˆæº
- `VectorSourceEstimate`: å‘é‡æº (3ä¸ªæ–¹å‘)

---

#### Brainstorm3: Results ç»“æ„ä½“

```matlab
ResultsMat =
    ImageGridAmp: [15000Ã—700 double]   % æºä¿¡å· [æº Ã— æ—¶é—´]
    ImagingKernel: []                  % ç©º (å®Œæ•´è§£) æˆ– [15000Ã—306] (æ ¸)
    Time: [1Ã—700 double]
    nComponents: 1                     % æ¯æºçš„æˆåˆ†æ•°
    Function: 'mn'                     % æ–¹æ³• (mn, dspm, sloreta)
    HeadModelFile: 'headmodel_*.mat'   % å…³è”å¤´æ¨¡å‹
    SurfaceFile: 'cortex_*.mat'        % å…³è”è¡¨é¢
    GridLoc: [15000Ã—3 double]          % æºä½ç½® (å¯é€‰)
    GridOrient: [15000Ã—3 double]       % æºæ–¹å‘ (å¯é€‰)
    Comment: 'MN: MEG'
    DataFile: 'data_*.mat'             % å…³è”æ•°æ®æ–‡ä»¶
```

**ä¸¤ç§å­˜å‚¨ç­–ç•¥**:
1. **å®Œæ•´è§£** (`ImageGridAmp`): å­˜å‚¨æ‰€æœ‰æºçš„æ¿€æ´»
2. **æˆåƒæ ¸** (`ImagingKernel`): å­˜å‚¨é€†ç®—å­,èŠ‚çœç©ºé—´

---

## æ–‡ä»¶æ ¼å¼ç­–ç•¥

### MNE-Python: å¼€æ”¾æ ¼å¼ + FIF

**ä¸»è¦æ ¼å¼**:

| æ ¼å¼ | ç”¨é€” | ä¼˜åŠ¿ | åŠ£åŠ¿ |
|------|------|------|------|
| **FIF** | MNEåŸç”Ÿæ ¼å¼ | æœ€å¿«, å…ƒæ•°æ®å®Œæ•´ | éæ ‡å‡† |
| **HDF5** | å¤§æ•°æ®å­˜å‚¨ | å‹ç¼©, åˆ†å—è®¿é—® | éœ€h5py |
| **NumPy** | æ•°æ®æ•°ç»„ | ç®€å•, é€šç”¨ | æ— å…ƒæ•°æ® |
| **Pickle** | Pythonå¯¹è±¡ | å®Œæ•´åºåˆ—åŒ– | ä¸è·¨è¯­è¨€ |

```python
# ä¿å­˜/åŠ è½½
raw.save('data.fif')                    # FIFæ ¼å¼
raw = mne.io.read_raw_fif('data.fif')

epochs.save('epochs-epo.fif')           # Epochsä¸“ç”¨åç¼€
evoked.save('evoked-ave.fif')           # Evokedä¸“ç”¨åç¼€
stc.save('stc-lh.stc')                  # æºä¼°è®¡ (å·¦åŠçƒ)
```

**è®¾è®¡ç†å¿µ**:
- ä¼˜å…ˆæ”¯æŒå¼€æ”¾æ ‡å‡† (EDF, BDF, EEGLAB)
- FIFç”¨äºå†…éƒ¨é«˜æ•ˆå­˜å‚¨
- é¼“åŠ±å¯¼å‡ºä¸ºå¼€æ”¾æ ¼å¼

---

### Brainstorm3: MATLAB .mat ç»Ÿä¸€

**ç»Ÿä¸€æ ¼å¼**: æ‰€æœ‰æ•°æ®éƒ½æ˜¯ `.mat` æ–‡ä»¶

```matlab
% æ–‡ä»¶å‘½åçº¦å®š
brainstormsubject.mat       % å—è¯•è€…ä¿¡æ¯
subjectimage_*.mat          % MRIæ•°æ®
tess_*.mat                  % è¡¨é¢ç½‘æ ¼
channel_*.mat               % é€šé“/ä¼ æ„Ÿå™¨
data_*.mat                  % è®°å½•æ•°æ®
headmodel_*.mat             % å¤´æ¨¡å‹
results_*.mat               % æºä¼°è®¡ç»“æœ
timefreq_*.mat              % æ—¶é¢‘åˆ†æ
matrix_*.mat                % é€šç”¨çŸ©é˜µ
```

**ä¼˜åŠ¿**:
- âœ… ç»Ÿä¸€æ ¼å¼,æ˜“äºç†è§£
- âœ… MATLABç”Ÿæ€å…¼å®¹
- âœ… å¯ç›´æ¥åœ¨MATLABä¸­æ£€æŸ¥

**åŠ£åŠ¿**:
- âŒ ä¸Pythoné›†æˆéœ€scipy.io
- âŒ å¤§æ–‡ä»¶IOæ…¢ (ç›¸æ¯”HDF5)

---

## å†…å­˜ç®¡ç†æœºåˆ¶

### MNE-Python: å»¶è¿ŸåŠ è½½ + å†…å­˜æ˜ å°„

```python
# ç­–ç•¥1: å»¶è¿ŸåŠ è½½ (é»˜è®¤)
raw = mne.io.read_raw_fif('huge_file.fif', preload=False)
# åªåŠ è½½å…ƒæ•°æ® (info), ä¸åŠ è½½æ•°æ®

# æŒ‰éœ€è®¿é—®
data_chunk = raw[:, 1000:2000]  # åªåŠ è½½è¿™éƒ¨åˆ†
# è‡ªåŠ¨ä»ç£ç›˜è¯»å–

# ç­–ç•¥2: å®Œå…¨åŠ è½½
raw = mne.io.read_raw_fif('small_file.fif', preload=True)
# æ•°æ®å®Œå…¨åœ¨å†…å­˜ä¸­,æ“ä½œæ›´å¿«

# ç­–ç•¥3: å†…å­˜æ˜ å°„ (å¤§æ–‡ä»¶æœ€ä½³)
raw = mne.io.read_raw_fif('huge_file.fif', preload='memmap')
# ä½¿ç”¨mmap,å…è®¸è¶…å¤§æ–‡ä»¶
```

**å†…å­˜ä¼°ç®—**:
```python
raw.estimate_memory_usage()
# '~141.1 MB' (æœªåŠ è½½) æˆ–å®é™…å†…å­˜ä½¿ç”¨

# è®¡ç®—å…¬å¼
# n_channels Ã— n_samples Ã— 8 bytes (float64)
# 306 Ã— 60000 Ã— 8 = 146,880,000 bytes â‰ˆ 140 MB
```

---

### Brainstorm3: MATLABå†…å­˜ç®¡ç†

```matlab
% MATLABè‡ªåŠ¨ç®¡ç†
% åŠ è½½æ•°æ®æ—¶å®Œå…¨è¯»å…¥å†…å­˜

DataMat = in_bst_data('data_*.mat');
% DataMat.F ç›´æ¥åœ¨å†…å­˜ä¸­ [nChannels Ã— nTime]

% å¤§æ–‡ä»¶å¤„ç†
% éœ€è¦æ‰‹åŠ¨åˆ†å‰²æˆ–ä½¿ç”¨matfileå¯¹è±¡

m = matfile('huge_data.mat');
data_chunk = m.F(:, 1000:2000);  % éƒ¨åˆ†åŠ è½½
```

---

## å…ƒæ•°æ®å¤„ç†

### MNE-Python: Info å¯¹è±¡

```python
# Infoæ˜¯ä¸€ä¸ªå­—å…¸,åŒ…å«40+ä¸ªå­—æ®µ
info = raw.info

# å…³é”®å­—æ®µ
info['ch_names']      # é€šé“ååˆ—è¡¨
info['sfreq']         # é‡‡æ ·ç‡
info['chs']           # é€šé“è¯¦æƒ… (ä½ç½®, æ ¡å‡†, ç±»å‹)
info['dev_head_t']    # è®¾å¤‡-å¤´éƒ¨å˜æ¢çŸ©é˜µ (MEG)
info['dig']           # æ•°å­—åŒ–ç‚¹ (å¤´éƒ¨å½¢çŠ¶, ç”µæä½ç½®)
info['meas_date']     # é‡‡é›†æ—¶é—´
info['subject_info']  # å—è¯•è€…ä¿¡æ¯ (å¹´é¾„, æ€§åˆ«...)
info['proj']          # SSPæŠ•å½±ç®—å­
info['bads']          # åé€šé“åˆ—è¡¨

# æ“ä½œ
info['bads'] = ['MEG 0113', 'MEG 0112']  # æ ‡è®°åé€šé“
raw.pick_types(meg=True, eeg=False)      # é€šé“é€‰æ‹©
raw.info = mne.pick_info(raw.info, sel)  # æ›´æ–°info
```

---

### Brainstorm3: åˆ†æ•£åœ¨å¤šä¸ªå­—æ®µ

```matlab
% Channelä¿¡æ¯ (ç‹¬ç«‹æ–‡ä»¶)
ChannelMat =
    Channel(1:306).Name      % é€šé“å
    Channel(1:306).Type      % ç±»å‹ (MEG, EEG, ...)
    Channel(1:306).Loc       % ä½ç½® [3Ã—2] (èµ·ç‚¹, ç»ˆç‚¹)
    Channel(1:306).Orient    % æ–¹å‘ [3Ã—1]
    Channel(1:306).Weight    % æƒé‡
    MegRefCoef               % MEGå‚è€ƒç³»æ•°
    Projector                % SSPæŠ•å½±çŸ©é˜µ
    
% æ•°æ®æ–‡ä»¶åªåŒ…å«å¼•ç”¨
DataMat.ChannelFlag          % é€šé“æ ‡è®° (å¥½/å)
DataMat.Device               % è®¾å¤‡åç§°
```

---

## äº’æ“ä½œæ€§

### æ ¼å¼è½¬æ¢çŸ©é˜µ

| æºæ ¼å¼ | MNEè¯»å– | Brainstormè¯»å– |
|--------|---------|----------------|
| **FIF** | âœ… åŸç”Ÿ | âœ… æ”¯æŒ |
| **EDF/BDF** | âœ… | âœ… |
| **EEGLAB** | âœ… | âœ… |
| **FieldTrip** | âœ… (.mat) | âœ… åŸç”Ÿ |
| **Brainstorm .mat** | âœ… scipy.io | âœ… åŸç”Ÿ |
| **CTF** | âœ… | âœ… |
| **Neuromag** | âœ… | âœ… |

---

### MNE â†’ Brainstorm

```python
import mne
import scipy.io

# æ–¹æ³•1: å¯¼å‡ºä¸º.mat
raw = mne.io.read_raw_fif('data.fif', preload=True)
data_dict = {
    'F': raw.get_data(),
    'Time': raw.times,
    'ChannelFlag': [1] * len(raw.ch_names),
    'Comment': 'Exported from MNE'
}
scipy.io.savemat('for_brainstorm.mat', data_dict)

# æ–¹æ³•2: å¯¼å‡ºFIF (Brainstormå¯ç›´æ¥å¯¼å…¥)
raw.save('data_for_bst.fif')
# åœ¨Brainstormä¸­: File > Import data > MNE-Python FIF
```

---

### Brainstorm â†’ MNE

```python
import scipy.io
import mne

# åŠ è½½Brainstormæ•°æ®
mat = scipy.io.loadmat('brainstorm_data.mat')

data = mat['F']        # [n_channels Ã— n_times]
sfreq = 1 / (mat['Time'][0, 1] - mat['Time'][0, 0])

# åˆ›å»ºMNEå¯¹è±¡
info = mne.create_info(
    ch_names=[f'CH{i}' for i in range(data.shape[0])],
    sfreq=sfreq,
    ch_types='eeg'
)
raw = mne.io.RawArray(data, info)
```

---

## æ€»ç»“

### è®¾è®¡å“²å­¦å·®å¼‚

| ç»´åº¦ | MNE-Python | Brainstorm3 |
|------|------------|-------------|
| **æ ¸å¿ƒæŠ½è±¡** | å¯¹è±¡ (Class) | ç»“æ„ä½“ (Struct) + æ–‡ä»¶ |
| **æ•°æ®æŒä¹…åŒ–** | æŒ‰éœ€ä¿å­˜ | æ¯æ­¥è‡ªåŠ¨ä¿å­˜ |
| **å†…å­˜ç­–ç•¥** | å»¶è¿ŸåŠ è½½ + mmap | å®Œå…¨åŠ è½½ |
| **å…ƒæ•°æ®** | Infoå¯¹è±¡ (é›†ä¸­) | åˆ†æ•£åœ¨å¤šä¸ªæ–‡ä»¶ |
| **ç±»å‹ç³»ç»Ÿ** | å¼ºç±»å‹ (å¤šç§ç±») | å¼±ç±»å‹ (ç»Ÿä¸€ç»“æ„ä½“) |
| **æ“ä½œæ–¹å¼** | æ–¹æ³•è°ƒç”¨ | è¿›ç¨‹å‡½æ•° + GUI |

---

### å„è‡ªä¼˜åŠ¿

**MNE-Python**:
- âœ… å†…å­˜é«˜æ•ˆ (å¤§æ•°æ®å‹å¥½)
- âœ… çµæ´»çš„æ•°æ®æ“ä½œ (åˆ‡ç‰‡, ç´¢å¼•)
- âœ… å¼ºç±»å‹å®‰å…¨
- âœ… æ˜“äºè‡ªåŠ¨åŒ–

**Brainstorm3**:
- âœ… è‡ªåŠ¨æŒä¹…åŒ– (ä¸ä¼šä¸¢å¤±å·¥ä½œ)
- âœ… å†å²è¿½è¸ªå®Œæ•´
- âœ… GUIå®æ—¶åŒæ­¥
- âœ… è·¨ä¼šè¯å·¥ä½œæµ

---

### é€‰æ‹©å»ºè®®

**å¦‚æœä½ éœ€è¦**:
- ğŸ“Š **å¤§æ•°æ®å¤„ç†** (>10GB) â†’ MNE-Python
- ğŸ’¾ **è‡ªåŠ¨ä¿å­˜/å†å²** â†’ Brainstorm3
- ğŸ **Pythoné›†æˆ** â†’ MNE-Python
- ğŸ–±ï¸ **GUIæ“ä½œ** â†’ Brainstorm3
- âš¡ **é«˜æ€§èƒ½è®¡ç®—** â†’ MNE-Python
- ğŸ“ **æ•™å­¦æ¼”ç¤º** â†’ Brainstorm3

ä¸¤è€…çš„æ ¸å¿ƒæ•°æ®æ¨¡å‹è™½ç„¶å®ç°ä¸åŒ,ä½†éƒ½èƒ½å®Œæˆç›¸åŒçš„ç§‘å­¦ä»»åŠ¡! ğŸ¯
